<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FMCG Asset Management - ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô FMCG</title>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Prompt', sans-serif;
            background: #f0f9f9;
            overflow-x: hidden;
        }

        /* Teal Color Scheme */
        :root {
            --primary: #14b8a6;
            --primary-dark: #0d9488;
            --primary-light: #5eead4;
            --secondary: #06b6d4;
            --accent: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
        }

        /* Sidebar */
        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            width: 260px;
            height: 100vh;
            background: linear-gradient(180deg, var(--primary) 0%, var(--primary-dark) 100%);
            padding: 20px;
            overflow-y: auto;
            z-index: 1000;
            box-shadow: 3px 0 10px rgba(0,0,0,0.1);
            transition: all 0.3s;
        }

        .sidebar.collapsed {
            width: 70px;
        }

        .logo {
            color: white;
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 40px;
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            white-space: nowrap;
        }

        .logo i {
            font-size: 32px;
        }

        .sidebar.collapsed .logo span,
        .sidebar.collapsed .menu-item span {
            display: none;
        }

        .menu-item {
            color: rgba(255,255,255,0.8);
            padding: 15px 20px;
            margin-bottom: 10px;
            border-radius: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 15px;
            transition: all 0.3s;
            white-space: nowrap;
        }

        .menu-item:hover {
            background: rgba(255,255,255,0.1);
            color: white;
        }

        .menu-item.active {
            background: white;
            color: var(--primary);
            font-weight: 600;
        }

        .menu-item i {
            font-size: 18px;
            width: 25px;
        }

        .menu-toggle {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .menu-toggle:hover {
            background: rgba(255,255,255,0.3);
        }

        /* Main Content */
        .main-content {
            margin-left: 260px;
            padding: 20px;
            min-height: 100vh;
            transition: all 0.3s;
        }

        .sidebar.collapsed + .main-content {
            margin-left: 70px;
        }

        /* Header */
        .header {
            background: white;
            padding: 20px 30px;
            border-radius: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            color: #333;
            font-size: 26px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .header-actions {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, var(--accent) 0%, #059669 100%);
            color: white;
        }

        .btn-warning {
            background: linear-gradient(135deg, var(--warning) 0%, #d97706 100%);
            color: white;
        }

        .btn-secondary {
            background: #e0e0e0;
            color: #333;
        }

        .btn-info {
            background: linear-gradient(135deg, var(--secondary) 0%, #0891b2 100%);
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 15px;
            background: #f8f9fa;
            border-radius: 25px;
            cursor: pointer;
        }

        .user-avatar {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        /* Page Container */
        .page {
            display: none;
            animation: fadeIn 0.3s;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            display: flex;
            align-items: center;
            gap: 20px;
            transition: all 0.3s;
            cursor: pointer;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 26px;
            color: white;
        }

        .stat-icon.teal { background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%); }
        .stat-icon.green { background: linear-gradient(135deg, var(--accent) 0%, #059669 100%); }
        .stat-icon.cyan { background: linear-gradient(135deg, var(--secondary) 0%, #0891b2 100%); }
        .stat-icon.orange { background: linear-gradient(135deg, var(--warning) 0%, #d97706 100%); }
        .stat-icon.red { background: linear-gradient(135deg, var(--danger) 0%, #dc2626 100%); }

        .stat-info h3 {
            font-size: 28px;
            color: #333;
            font-weight: bold;
        }

        .stat-info p {
            color: #888;
            font-size: 14px;
            margin-top: 5px;
        }

        /* Charts */
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .chart-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .chart-card h2 {
            color: #333;
            font-size: 18px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Card Grid for Department Cards */
        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        /* Table */
        .table-container {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            overflow-x: auto;
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .table-header h2 {
            color: #333;
            font-size: 18px;
        }

        .search-box {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .search-box input {
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            width: 250px;
            font-size: 14px;
        }

        .search-box select {
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        thead {
            background: #f8f9fa;
        }

        th {
            padding: 15px;
            text-align: left;
            font-weight: 600;
            color: #333;
            font-size: 14px;
        }

        td {
            padding: 15px;
            border-bottom: 1px solid #f0f0f0;
            font-size: 14px;
            color: #666;
        }

        tbody tr {
            transition: all 0.3s;
        }

        tbody tr:hover {
            background: #f8f9fa;
        }

        .badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
            display: inline-block;
        }

        .badge.available {
            background: #d1fae5;
            color: #065f46;
        }

        .badge.in-use {
            background: #fef3c7;
            color: #92400e;
        }

        .badge.maintenance {
            background: #fee2e2;
            color: #991b1b;
        }

        .badge.retired {
            background: #e2e3e5;
            color: #383d41;
        }

        /* New warehouse status badges */
        .badge.complete {
            background: #d1fae5;
            color: #065f46;
        }

        .badge.repair {
            background: #fef3c7;
            color: #92400e;
        }

        .badge.damaged {
            background: #fed7aa;
            color: #9a3412;
        }

        .badge.broken {
            background: #fee2e2;
            color: #991b1b;
        }

        .action-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            margin-right: 5px;
            transition: all 0.3s;
        }

        .action-btn:hover {
            transform: scale(1.05);
        }

        .action-btn.view {
            background: #e0f2fe;
            color: #075985;
        }

        .action-btn.edit {
            background: #d1fae5;
            color: #065f46;
        }

        .action-btn.delete {
            background: #fee2e2;
            color: #991b1b;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            max-width: 800px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            animation: slideUp 0.3s;
        }

        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }

        .modal-header h3 {
            color: #333;
            font-size: 22px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .close-modal {
            width: 35px;
            height: 35px;
            border: none;
            background: #f5f5f5;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .close-modal:hover {
            background: #e0e0e0;
            transform: rotate(90deg);
        }

        /* Form */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        .form-group label {
            color: #333;
            font-weight: 500;
            margin-bottom: 8px;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .form-group label .required {
            color: var(--danger);
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            font-family: inherit;
            transition: all 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(20, 184, 166, 0.1);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .form-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 20px;
        }

        /* Upload Area */
        .upload-area {
            border: 2px dashed var(--primary);
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            background: #f0fdfa;
            cursor: pointer;
            transition: all 0.3s;
        }

        .upload-area:hover {
            background: #ccfbf1;
            border-color: var(--primary-dark);
        }

        .upload-area i {
            font-size: 48px;
            color: var(--primary);
            margin-bottom: 15px;
        }

        .upload-area p {
            color: #666;
            margin-bottom: 10px;
        }

        .upload-area .btn {
            margin-top: 10px;
        }

        /* Google Sheets Config */
        .config-box {
            background: #f0fdfa;
            border: 1px solid var(--primary-light);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .config-box h3 {
            color: var(--primary-dark);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .config-status {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 500;
        }

        .config-status.connected {
            background: #d1fae5;
            color: #065f46;
        }

        .config-status.disconnected {
            background: #fee2e2;
            color: #991b1b;
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            display: none;
            animation: slideIn 0.3s;
            z-index: 3000;
            min-width: 300px;
        }

        .notification.active {
            display: block;
        }

        @keyframes slideIn {
            from { transform: translateX(400px); }
            to { transform: translateX(0); }
        }

        .notification.success {
            border-left: 4px solid var(--accent);
        }

        .notification.error {
            border-left: 4px solid var(--danger);
        }

        .notification.warning {
            border-left: 4px solid var(--warning);
        }

        /* Loading */
        .loading {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255,255,255,0.9);
            z-index: 3000;
            align-items: center;
            justify-content: center;
        }

        .loading.active {
            display: flex;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                width: 70px;
            }

            .sidebar .logo span,
            .sidebar .menu-item span {
                display: none;
            }

            .main-content {
                margin-left: 70px;
            }

            .stats-grid,
            .charts-grid,
            .card-grid {
                grid-template-columns: 1fr;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .header {
                flex-direction: column;
                gap: 15px;
            }

            .table-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .search-box {
                width: 100%;
            }

            .search-box input,
            .search-box select {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- Notification -->
    <div id="notification" class="notification">
        <div style="display: flex; align-items: start; gap: 15px;">
            <i class="fas fa-check-circle" style="font-size: 24px; color: var(--accent);"></i>
            <div>
                <h4 id="notificationTitle" style="margin-bottom: 5px;">‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</h4>
                <p id="notificationMessage" style="color: #666; font-size: 14px;">‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</p>
            </div>
        </div>
    </div>

    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="logo">
            <i class="fas fa-warehouse"></i>
            <span>FMCG Asset</span>
        </div>
        
        <div class="menu-item active" onclick="showPage('dashboard')">
            <i class="fas fa-home"></i>
            <span>‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î</span>
        </div>
        
        <div class="menu-item" onclick="showPage('assets')">
            <i class="fas fa-boxes"></i>
            <span>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô</span>
        </div>

        <div class="menu-item" onclick="showPage('add-asset')">
            <i class="fas fa-plus-circle"></i>
            <span>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô</span>
        </div>

        <div class="menu-item" onclick="showPage('import')">
            <i class="fas fa-file-excel"></i>
            <span>Import Excel</span>
        </div>
        
        <div class="menu-item" onclick="showPage('departments')">
            <i class="fas fa-building"></i>
            <span>‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡πÅ‡∏ú‡∏ô‡∏Å</span>
        </div>

        <div class="menu-item" onclick="showPage('locations')">
            <i class="fas fa-map-marker-alt"></i>
            <span>‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö</span>
        </div>
        
        <div class="menu-item" onclick="showPage('maintenance')">
            <i class="fas fa-wrench"></i>
            <span>‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤</span>
        </div>
        
        <div class="menu-item" onclick="showPage('reports')">
            <i class="fas fa-chart-bar"></i>
            <span>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</span>
        </div>
        
        <div class="menu-item" onclick="showPage('settings')">
            <i class="fas fa-cog"></i>
            <span>‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</span>
        </div>

        <button class="menu-toggle" onclick="toggleSidebar()">
            <i class="fas fa-bars"></i>
        </button>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Dashboard Page -->
        <div id="dashboard" class="page active">
            <div class="header">
                <h1><i class="fas fa-home"></i> ‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î FMCG</h1>
                <div class="header-actions">
                    <button class="btn btn-info" onclick="showPage('import')">
                        <i class="fas fa-file-excel"></i>
                        Import Excel
                    </button>
                    <button class="btn btn-success" onclick="showPage('add-asset')">
                        <i class="fas fa-plus"></i>
                        ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô
                    </button>
                    </div>
            </div>

            <!-- Google Sheets Status -->
            <div class="config-box">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <h3><i class="fas fa-database"></i> ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Google Sheets</h3>
                        <p id="sheetsStatus" style="color: #666; margin-top: 5px;">
                            <span class="config-status disconnected">
                                <i class="fas fa-times-circle"></i>
                                ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
                            </span>
                        </p>
                    </div>
                    <button class="btn btn-primary" onclick="showPage('settings')">
                        <i class="fas fa-cog"></i>
                        ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
                    </button>
                </div>
            </div>

            <!-- Stats -->
            <div class="stats-grid">
                <div class="stat-card" onclick="showPage('assets')">
                    <div class="stat-icon teal">
                        <i class="fas fa-boxes"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="totalAssets">0</h3>
                        <p>‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon green">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="availableAssets">0</h3>
                        <p>‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå</p>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon cyan">
                        <i class="fas fa-tools"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="inUseAssets">0</h3>
                        <p>‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°</p>
                    </div>
                </div>

                <div class="stat-card" onclick="showPage('maintenance')">
                    <div class="stat-icon orange">
                        <i class="fas fa-wrench"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="maintenanceAssets">0</h3>
                        <p>‡∏ä‡∏≥‡∏£‡∏∏‡∏î/‡πÄ‡∏™‡∏µ‡∏¢</p>
                    </div>
                </div>
            </div>

            <!-- Charts -->
            <div class="charts-grid">
                <div class="chart-card">
                    <h2><i class="fas fa-chart-pie"></i> ‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏ï‡∏≤‡∏°‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</h2>
                    <canvas id="categoryChart"></canvas>
                </div>

                <div class="chart-card">
                    <h2><i class="fas fa-chart-bar"></i> ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô</h2>
                    <canvas id="statusDashChart"></canvas>
                </div>
            </div>

            <!-- Recent Assets -->
            <div class="table-container">
                <div class="table-header">
                    <h2><i class="fas fa-clock"></i> ‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h2>
                    <button class="btn btn-primary" onclick="showPage('assets')">
                        ‡∏î‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î <i class="fas fa-arrow-right"></i>
                    </button>
                </div>

                <table>
                    <thead>
                        <tr>
                            <th>‡∏£‡∏´‡∏±‡∏™</th>
                            <th>‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô</th>
                            <th>‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</th>
                            <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                            <th>‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤ (‡∏ø)</th>
                        </tr>
                    </thead>
                    <tbody id="recentAssetsTable">
                        <tr>
                            <td colspan="5" style="text-align: center; color: #aaa; padding: 40px;">
                                ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏´‡∏£‡∏∑‡∏≠ Import Excel
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Assets List Page -->
        <div id="assets" class="page">
            <div class="header">
                <h1><i class="fas fa-boxes"></i> ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô</h1>
                <div class="header-actions">
                    <button class="btn btn-info" onclick="loadFromGoogleSheets()">
                        <i class="fas fa-sync"></i>
                        Sync
                    </button>
                    <button class="btn btn-success" onclick="showPage('add-asset')">
                        <i class="fas fa-plus"></i>
                        ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô
                    </button>
                    <button class="btn btn-info" onclick="showPage('import')">
                        <i class="fas fa-file-excel"></i>
                        Import
                    </button>
                    <button class="btn btn-primary" onclick="exportToExcel()">
                        <i class="fas fa-file-export"></i>
                        Export
                    </button>
                </div>
            </div>

            <div class="table-container">
                <div class="table-header">
                    <h2>‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (<span id="assetCount">0</span> ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)</h2>
                    <div class="search-box">
                        <input type="text" placeholder="üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤..." id="searchAsset" onkeyup="filterAssets()">
                        <select id="filterCategory" onchange="filterAssets()">
                            <option value="">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                            <option value="‡∏û‡∏≤‡πÄ‡∏•‡∏ó">‡∏û‡∏≤‡πÄ‡∏•‡∏ó</option>
                            <option value="TOTE">TOTE</option>
                            <option value="‡∏ï‡∏∞‡πÅ‡∏Å‡∏£‡∏á‡∏Å‡∏£‡∏á">‡∏ï‡∏∞‡πÅ‡∏Å‡∏£‡∏á‡∏Å‡∏£‡∏á</option>
                            <option value="RF Scanner">RF Scanner</option>
                            <option value="IData">IData</option>
                            <option value="‡πÅ‡∏ö‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡∏µ‡πà RF">‡πÅ‡∏ö‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡∏µ‡πà RF</option>
                            <option value="‡πÅ‡∏ö‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡∏µ‡πà IData">‡πÅ‡∏ö‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡∏µ‡πà IData</option>
                            <option value="‡∏ß‡∏¥‡∏ó‡∏¢‡∏∏‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£">‡∏ß‡∏¥‡∏ó‡∏¢‡∏∏‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£</option>
                            <option value="Cutter Safety">Cutter Safety</option>
                            <option value="‡∏£‡∏ñ‡πÇ‡∏ü‡∏•‡πå‡∏Ñ‡∏•‡∏¥‡∏ü‡∏ó‡πå">‡∏£‡∏ñ‡πÇ‡∏ü‡∏•‡πå‡∏Ñ‡∏•‡∏¥‡∏ü‡∏ó‡πå</option>
                            <option value="‡∏ä‡∏±‡πâ‡∏ô‡∏ß‡∏≤‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤">‡∏ä‡∏±‡πâ‡∏ô‡∏ß‡∏≤‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</option>
                            <option value="‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏Ñ‡∏•‡∏±‡∏á">‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏Ñ‡∏•‡∏±‡∏á</option>
                            <option value="‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£">‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£</option>
                        </select>
                        <select id="filterStatus" onchange="filterAssets()">
                            <option value="">‡∏ó‡∏∏‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</option>
                            <option value="‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå">‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå</option>
                            <option value="‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°">‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°</option>
                            <option value="‡∏ä‡∏≥‡∏£‡∏∏‡∏î">‡∏ä‡∏≥‡∏£‡∏∏‡∏î</option>
                            <option value="‡πÄ‡∏™‡∏µ‡∏¢">‡πÄ‡∏™‡∏µ‡∏¢</option>
                        </select>
                    </div>
                </div>

                <table id="assetsTable">
                    <thead>
                        <tr>
                            <th>‡∏£‡∏´‡∏±‡∏™</th>
                            <th>‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô</th>
                            <th>‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</th>
                            <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà</th>
                            <th>‡πÅ‡∏ú‡∏ô‡∏Å</th>
                            <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                            <th>‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤ (‡∏ø)</th>
                            <th>‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                        </tr>
                    </thead>
                    <tbody id="assetsTableBody">
                        <tr>
                            <td colspan="8" style="text-align: center; color: #aaa; padding: 40px;">
                                ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏´‡∏£‡∏∑‡∏≠ Import Excel
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Add Asset Page -->
        <div id="add-asset" class="page">
            <div class="header">
                <h1><i class="fas fa-plus-circle"></i> ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡πÉ‡∏´‡∏°‡πà</h1>
                <div class="header-actions">
                    <button class="btn btn-secondary" onclick="showPage('assets')">
                        <i class="fas fa-arrow-left"></i>
                        ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                    </button>
                    <button class="btn btn-success" onclick="saveNewAsset()">
                        <i class="fas fa-save"></i>
                        ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
                    </button>
                </div>
            </div>

            <div class="table-container">
                <h2 style="margin-bottom: 25px;">
                    <i class="fas fa-info-circle"></i> ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô
                </h2>

                <div class="form-grid">
                    <div class="form-group">
                        <label>‡∏£‡∏´‡∏±‡∏™‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô <span class="required">*</span></label>
                        <input type="text" id="newAssetCode" placeholder="‡πÄ‡∏ä‡πà‡∏ô PLT-001" required>
                    </div>

                    <div class="form-group">
                        <label>‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà <span class="required">*</span></label>
                        <select id="newCategory" required>
                            <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</option>
                            <option>‡∏û‡∏≤‡πÄ‡∏•‡∏ó</option>
                            <option>TOTE</option>
                            <option>‡∏ï‡∏∞‡πÅ‡∏Å‡∏£‡∏á‡∏Å‡∏£‡∏á</option>
                            <option>RF Scanner</option>
                            <option>IData</option>
                            <option>‡πÅ‡∏ö‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡∏µ‡πà RF</option>
                            <option>‡πÅ‡∏ö‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡∏µ‡πà IData</option>
                            <option>‡∏ß‡∏¥‡∏ó‡∏¢‡∏∏‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£</option>
                            <option>Cutter Safety</option>
                            <option>‡∏£‡∏ñ‡πÇ‡∏ü‡∏•‡πå‡∏Ñ‡∏•‡∏¥‡∏ü‡∏ó‡πå</option>
                            <option>‡∏ä‡∏±‡πâ‡∏ô‡∏ß‡∏≤‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</option>
                            <option>‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏Ñ‡∏•‡∏±‡∏á</option>
                            <option>‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£</option>
                            <option>‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
                        </select>
                    </div>

                    <div class="form-group full-width">
                        <label>‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô <span class="required">*</span></label>
                        <input type="text" id="newAssetName" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô" required>
                    </div>

                    <div class="form-group">
                        <label>‡∏¢‡∏µ‡πà‡∏´‡πâ‡∏≠</label>
                        <input type="text" id="newBrand" placeholder="‡∏¢‡∏µ‡πà‡∏´‡πâ‡∏≠">
                    </div>

                    <div class="form-group">
                        <label>‡∏£‡∏∏‡πà‡∏ô</label>
                        <input type="text" id="newModel" placeholder="‡∏£‡∏∏‡πà‡∏ô">
                    </div>

                    <div class="form-group">
                        <label>Serial Number</label>
                        <input type="text" id="newSerial" placeholder="Serial Number">
                    </div>

                    <div class="form-group">
                        <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ã‡∏∑‡πâ‡∏≠ <span class="required">*</span></label>
                        <input type="date" id="newPurchaseDate" required>
                    </div>

                    <div class="form-group">
                        <label>‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ã‡∏∑‡πâ‡∏≠ (‡∏ø) <span class="required">*</span></label>
                        <input type="number" id="newPrice" placeholder="0.00" required>
                    </div>

                    <div class="form-group">
                        <label>‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö <span class="required">*</span></label>
                        <select id="newLocation" required>
                            <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà</option>
                            <option>‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å - ‡πÇ‡∏ã‡∏ô A</option>
                            <option>‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å - ‡πÇ‡∏ã‡∏ô B</option>
                            <option>‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å - ‡πÇ‡∏ã‡∏ô C</option>
                            <option>‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏£‡∏≠‡∏á</option>
                            <option>‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>‡πÅ‡∏ú‡∏ô‡∏Å</label>
                        <select id="newDepartment">
                            <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ú‡∏ô‡∏Å</option>
                            <option>‡∏™‡∏≥‡∏£‡∏≠‡∏á</option>
                            <option>AC</option>
                            <option>AP</option>
                            <option>APB</option>
                            <option>CF</option>
                            <option>APL</option>
                            <option>CP</option>
                            <option>DP</option>
                            <option>INV</option>
                            <option>LS</option>
                            <option>QA</option>
                            <option>RC</option>
                            <option>ST</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</label>
                        <select id="newStatus">
                            <option>‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå</option>
                            <option>‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°</option>
                            <option>‡∏ä‡∏≥‡∏£‡∏∏‡∏î</option>
                            <option>‡πÄ‡∏™‡∏µ‡∏¢</option>
                        </select>
                    </div>

                    <div class="form-group full-width">
                        <label>‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢</label>
                        <textarea id="newDescription" placeholder="‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°..."></textarea>
                    </div>
                </div>

                <div class="form-actions">
                    <button class="btn btn-secondary" onclick="showPage('assets')">
                        <i class="fas fa-times"></i>
                        ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                    </button>
                    <button class="btn btn-success" onclick="saveNewAsset()">
                        <i class="fas fa-save"></i>
                        ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô
                    </button>
                </div>
            </div>
        </div>

        <!-- Import Excel Page -->
        <div id="import" class="page">
            <div class="header">
                <h1><i class="fas fa-file-excel"></i> Import ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Excel</h1>
                <div class="header-actions">
                    <button class="btn btn-success" onclick="downloadTemplate()">
                        <i class="fas fa-download"></i>
                        ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î Template
                    </button>
                </div>
            </div>

            <div class="table-container">
                <h2 style="margin-bottom: 20px;">
                    <i class="fas fa-cloud-upload-alt"></i> ‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå Excel
                </h2>
                
                <div class="upload-area" onclick="document.getElementById('excelFile').click()">
                    <input type="file" id="excelFile" accept=".xlsx, .xls" style="display: none;" onchange="handleFileUpload(event)">
                    <i class="fas fa-file-excel"></i>
                    <h3>‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå Excel</h3>
                    <p>‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÑ‡∏ü‡∏•‡πå .xlsx ‡πÅ‡∏•‡∏∞ .xls</p>
                    <button class="btn btn-primary" onclick="event.stopPropagation();">
                        <i class="fas fa-folder-open"></i>
                        ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå
                    </button>
                </div>

                <div style="margin-top: 30px; padding: 20px; background: #fef3c7; border-radius: 10px; border-left: 4px solid var(--warning);">
                    <h4 style="color: #92400e; margin-bottom: 10px;">
                        <i class="fas fa-info-circle"></i> ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
                    </h4>
                    <ol style="color: #92400e; padding-left: 20px; line-height: 1.8;">
                        <li>‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î Template Excel ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô</li>
                        <li>‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏•‡∏á‡πÉ‡∏ô Template ‡∏ï‡∏≤‡∏°‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î</li>
                        <li>‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå Excel ‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß</li>
                        <li>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</li>
                    </ol>
                </div>
            </div>

            <div id="previewSection" style="display: none;">
                <div style="height: 30px;"></div>
                <div class="table-container">
                    <div class="table-header">
                        <h2><i class="fas fa-eye"></i> ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤</h2>
                        <button class="btn btn-success" onclick="confirmImport()">
                            <i class="fas fa-check"></i>
                            ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤
                        </button>
                    </div>
                    
                    <table>
                        <thead>
                            <tr>
                                <th>‡∏£‡∏´‡∏±‡∏™</th>
                                <th>‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô</th>
                                <th>‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</th>
                                <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà</th>
                                <th>‡πÅ‡∏ú‡∏ô‡∏Å</th>
                                <th>‡∏£‡∏≤‡∏Ñ‡∏≤ (‡∏ø)</th>
                                <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                            </tr>
                        </thead>
                        <tbody id="previewTableBody">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Departments Breakdown Page -->
        <div id="departments" class="page">
            <div class="header">
                <h1><i class="fas fa-building"></i> ‡πÅ‡∏¢‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡πÅ‡∏ú‡∏ô‡∏Å</h1>
                <div class="header-actions">
                    <button class="btn btn-success" onclick="exportDepartmentReport()">
                        <i class="fas fa-file-excel"></i>
                        Export ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô
                    </button>
                </div>
            </div>

            <!-- Department Summary Stats -->
            <div class="stats-grid" id="departmentStatsGrid">
                <div class="stat-card">
                    <div class="stat-icon teal">
                        <i class="fas fa-building"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="totalDepartments">0</h3>
                        <p>‡πÅ‡∏ú‡∏ô‡∏Å‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô</p>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon green">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="totalComplete">0</h3>
                        <p>‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon orange">
                        <i class="fas fa-tools"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="totalRepair">0</h3>
                        <p>‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon red">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="totalDamaged">0</h3>
                        <p>‡∏ä‡∏≥‡∏£‡∏∏‡∏î/‡πÄ‡∏™‡∏µ‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                    </div>
                </div>
            </div>

            <!-- Department Charts with Status Breakdown -->
            <div class="charts-grid">
                <div class="chart-card">
                    <h2><i class="fas fa-chart-bar"></i> ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÅ‡∏ú‡∏ô‡∏Å</h2>
                    <canvas id="departmentAssetChart"></canvas>
                </div>

                <div class="chart-card">
                    <h2><i class="fas fa-chart-pie"></i> ‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏ï‡∏≤‡∏°‡πÅ‡∏ú‡∏ô‡∏Å</h2>
                    <canvas id="departmentPieChart"></canvas>
                </div>
            </div>

            <!-- Department Detail Cards -->
            <div style="margin-bottom: 20px;">
                <h2 style="color: #333; font-size: 20px; margin-bottom: 20px;">
                    <i class="fas fa-list"></i> ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÅ‡∏ú‡∏ô‡∏Å
                </h2>
            </div>

            <div class="card-grid" id="departmentCardsGrid">
                <!-- Department cards will be generated here -->
            </div>

            <!-- Department Breakdown Table -->
            <div class="table-container" style="margin-top: 30px;">
                <h2 style="margin-bottom: 20px;">
                    <i class="fas fa-table"></i> ‡∏™‡∏£‡∏∏‡∏õ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡πÅ‡∏ú‡∏ô‡∏Å‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
                </h2>
                
                <table id="departmentBreakdownTable">
                    <thead>
                        <tr>
                            <th>‡πÅ‡∏ú‡∏ô‡∏Å</th>
                            <th style="text-align: center;">‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå</th>
                            <th style="text-align: center;">‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°</th>
                            <th style="text-align: center;">‡∏ä‡∏≥‡∏£‡∏∏‡∏î</th>
                            <th style="text-align: center;">‡πÄ‡∏™‡∏µ‡∏¢</th>
                            <th style="text-align: center;">‡∏£‡∏ß‡∏°</th>
                            <th>‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                        </tr>
                    </thead>
                    <tbody id="departmentBreakdownBody">
                        <tr>
                            <td colspan="7" style="text-align: center; color: #aaa; padding: 40px;">
                                ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Locations Page -->
        <div id="locations" class="page">
            <div class="header">
                <h1><i class="fas fa-map-marker-alt"></i> ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô</h1>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon teal">
                        <i class="fas fa-warehouse"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="totalLocations">0</h3>
                        <p>‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon cyan">
                        <i class="fas fa-boxes"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="avgCapacity">0%</h3>
                        <p>‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢</p>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon green">
                        <i class="fas fa-layer-group"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="totalAssetsInLocations">0</h3>
                        <p>‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon orange">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="fullLocations">0</h3>
                        <p>‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ï‡πá‡∏° (>90%)</p>
                    </div>
                </div>
            </div>

            <div class="table-container">
                <h2 style="margin-bottom: 20px;">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö</h2>
                
                <table>
                    <thead>
                        <tr>
                            <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà</th>
                            <th>‡πÇ‡∏ã‡∏ô</th>
                            <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô</th>
                            <th>‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</th>
                            <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                        </tr>
                    </thead>
                    <tbody id="locationsTableBody">
                        <tr>
                            <td colspan="5" style="text-align: center; color: #aaa; padding: 40px;">
                                ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Maintenance Page -->
        <div id="maintenance" class="page">
            <div class="header">
                <h1><i class="fas fa-wrench"></i> ‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤</h1>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon orange">
                        <i class="fas fa-calendar-alt"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="scheduledMaintenance">0</h3>
                        <p>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°</p>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon cyan">
                        <i class="fas fa-tools"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="inProgressMaintenance">0</h3>
                        <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</p>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon green">
                        <i class="fas fa-check-double"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="completedMaintenance">0</h3>
                        <p>‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå</p>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon teal">
                        <i class="fas fa-dollar-sign"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="maintenanceCost">‡∏ø0</h3>
                        <p>‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Å‡∏≤‡∏£</p>
                    </div>
                </div>
            </div>

            <div class="table-container">
                <h2 style="margin-bottom: 20px;">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤</h2>
                
                <table>
                    <thead>
                        <tr>
                            <th>‡∏£‡∏´‡∏±‡∏™‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô</th>
                            <th>‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô</th>
                            <th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏°</th>
                            <th>‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£</th>
                            <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                        </tr>
                    </thead>
                    <tbody id="maintenanceTableBody">
                        <tr>
                            <td colspan="5" style="text-align: center; color: #aaa; padding: 40px;">
                                ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Reports Page -->
        <div id="reports" class="page">
            <div class="header">
                <h1><i class="fas fa-chart-bar"></i> ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥</h1>
                <div class="header-actions">
                    <button class="btn btn-success" onclick="exportToExcel()">
                        <i class="fas fa-file-excel"></i>
                        Export Excel
                    </button>
                </div>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon teal">
                        <i class="fas fa-dollar-sign"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="totalValue">‡∏ø0</h3>
                        <p>‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon green">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="depreciationValue">‡∏ø0</h3>
                        <p>‡∏Ñ‡πà‡∏≤‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏°‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏∞‡∏™‡∏° (15%)</p>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon orange">
                        <i class="fas fa-wrench"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="maintenanceValueReport">‡∏ø0</h3>
                        <p>‡∏Ñ‡πà‡∏≤‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Å‡∏≤‡∏£</p>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon cyan">
                        <i class="fas fa-percentage"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="usageRate">0%</h3>
                        <p>‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</p>
                    </div>
                </div>
            </div>

            <div class="charts-grid">
                <div class="chart-card">
                    <h2><i class="fas fa-chart-bar"></i> ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</h2>
                    <canvas id="assetCountChart"></canvas>
                </div>

                <div class="chart-card">
                    <h2><i class="fas fa-chart-pie"></i> ‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô</h2>
                    <canvas id="statusChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Settings Page -->
        <div id="settings" class="page">
            <div class="header">
                <h1><i class="fas fa-cog"></i> ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö</h1>
                <div class="header-actions">
                    <button class="btn btn-success" onclick="saveSettings()">
                        <i class="fas fa-save"></i>
                        ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á
                    </button>
                </div>
            </div>

            <div class="table-container">
                <h2 style="margin-bottom: 25px;">
                    <i class="fas fa-database"></i> ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Google Sheets
                </h2>
                
                <div class="form-grid">
                    <div class="form-group full-width">
                        <label>Google Apps Script Web App URL <span class="required">*</span></label>
                        <input type="text" id="webAppUrl" placeholder="https://script.google.com/macros/s/...">
                        <small style="color: #666; margin-top: 5px; display: block;">
                            <i class="fas fa-info-circle"></i> 
                            Deploy Apps Script ‡πÅ‡∏•‡πâ‡∏ß copy Web app URL ‡∏°‡∏≤‡∏ß‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà
                        </small>
                    </div>

                    <div class="form-group">
                        <label>Sheet Name (Tab)</label>
                        <input type="text" id="sheetName" value="Assets" placeholder="Assets">
                    </div>

                    <div class="form-group">
                        <button class="btn btn-primary" onclick="testConnection()" style="margin-top: 28px; width: 100%;">
                            <i class="fas fa-plug"></i>
                            ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
                        </button>
                    </div>
                </div>

                <div id="connectionResult" style="display: none; margin-top: 20px; padding: 15px; border-radius: 8px;">
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px;">
                    <button class="btn btn-success" onclick="initializeGoogleSheets()">
                        <i class="fas fa-table"></i>
                        ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á (‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å)
                    </button>
                    <button class="btn btn-info" onclick="loadFromGoogleSheets()">
                        <i class="fas fa-sync"></i>
                        ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Sheets
                    </button>
                </div>
            </div>

            <div style="height: 30px;"></div>

            <div class="table-container">
                <h2 style="margin-bottom: 25px;">
                    <i class="fas fa-building"></i> ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó
                </h2>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label>‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó</label>
                        <input type="text" id="companyName" value="‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó FMCG ‡∏à‡∏≥‡∏Å‡∏±‡∏î">
                    </div>
                    
                    <div class="form-group">
                        <label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à</label>
                        <input type="text" value="FMCG / ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏∏‡∏õ‡πÇ‡∏†‡∏Ñ‡∏ö‡∏£‡∏¥‡πÇ‡∏†‡∏Ñ">
                    </div>
                    
                    <div class="form-group">
                        <label>‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</label>
                        <input type="tel" value="02-123-4567">
                    </div>
                    
                    <div class="form-group">
                        <label>‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label>
                        <input type="email" value="info@fmcg.com">
                    </div>

                    <div class="form-group full-width">
                        <label>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà</label>
                        <textarea>123 ‡∏ñ‡∏ô‡∏ô‡∏û‡∏£‡∏∞‡∏£‡∏≤‡∏° 9 ‡πÅ‡∏Ç‡∏ß‡∏á‡∏´‡πâ‡∏ß‡∏¢‡∏Ç‡∏ß‡∏≤‡∏á ‡πÄ‡∏Ç‡∏ï‡∏´‡πâ‡∏ß‡∏¢‡∏Ç‡∏ß‡∏≤‡∏á ‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø 10310</textarea>
                    </div>
                </div>
            </div>

            <div style="height: 30px;"></div>

            <div class="form-actions">
                <button class="btn btn-success" onclick="saveSettings()">
                    <i class="fas fa-save"></i>
                    ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                </button>
            </div>
        </div>
    </div>

    <!-- Loading -->
    <div id="loading" class="loading">
        <div class="spinner"></div>
    </div>

        <script>
        // ‚ö†Ô∏è Critical Functions - ‡∏ï‡πâ‡∏≠‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö onclick events
        
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            if (sidebar) sidebar.classList.toggle('collapsed');
        }

        function showPage(pageId) {
            // ‡∏£‡∏≠ DOM ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', function() {
                    showPage(pageId);
                });
                return;
            }
            
            // ‡∏ã‡πà‡∏≠‡∏ô‡∏ó‡∏∏‡∏Å‡∏´‡∏ô‡πâ‡∏≤
            const pages = document.querySelectorAll('.page');
            pages.forEach(page => page.classList.remove('active'));
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
            const targetPage = document.getElementById(pageId);
            if (targetPage) targetPage.classList.add('active');
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï active menu
            const menuItems = document.querySelectorAll('.menu-item');
            menuItems.forEach(item => item.classList.remove('active'));
            
            const activeMenu = Array.from(menuItems).find(item => 
                item.getAttribute('onclick') === "showPage('" + pageId + "')"
            );
            if (activeMenu) activeMenu.classList.add('active');
            
            // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡∏´‡∏ô‡πâ‡∏≤
            setTimeout(function() {
                if (pageId === 'dashboard') {
                    if (typeof initDashboardCharts === 'function') initDashboardCharts();
                    if (typeof updateDashboard === 'function') updateDashboard();
                } else if (pageId === 'reports') {
                    if (typeof initReportCharts === 'function') initReportCharts();
                    if (typeof updateReportsPage === 'function') updateReportsPage();
                } else if (pageId === 'assets') {
                    if (typeof renderAssetsTable === 'function') renderAssetsTable();
                } else if (pageId === 'departments') {
                    if (typeof updateDepartmentPage === 'function') updateDepartmentPage();
                } else if (pageId === 'locations') {
                    if (typeof updateLocationsPage === 'function') updateLocationsPage();
                } else if (pageId === 'maintenance') {
                    if (typeof updateMaintenancePage === 'function') updateMaintenancePage();
                }
            }, 100);
        }

        // Global Variables
        let assetsData = [];
        let importData = [];
        
        // ‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Google Apps Script URL (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•)
        const GOOGLE_APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzcSH7cQ3kYiSvMkj49uounseXuUAwH6q2iFS85fZFV8FcwoC0X5ojPOJpRNt1PAuge/exec';
        
        // ‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Google Sheets API (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡πá‡∏ß - ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
        const USE_SHEETS_API = true; // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô true ‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ Sheets API
        const SHEETS_API_KEY = 'AIzaSyCbId0_NCsmI84pl3vRJdqokZRHoMWHmCM';
        const SPREADSHEET_ID = '1o_Wpre0DNfh5XNIEiWR-8uI3zCDaYxCysI5utuDDkBI';
        const SHEET_NAME = 'Assets';
        
        let sheetsConfig = {
            webAppUrl: GOOGLE_APPS_SCRIPT_URL,
            sheetName: 'Assets'
        };
        let sheetsConfig = {
            webAppUrl: '',
            sheetName: 'Assets'
        };

        // Toggle Sidebar
        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('collapsed');
        }

        // Page Navigation
        function showPage(pageId) {
            const pages = document.querySelectorAll('.page');
            pages.forEach(page => page.classList.remove('active'));
            
            document.getElementById(pageId).classList.add('active');
            
            const menuItems = document.querySelectorAll('.menu-item');
            menuItems.forEach(item => item.classList.remove('active'));
            
            const clickedMenu = Array.from(menuItems).find(item => {
                return item.getAttribute('onclick') === `showPage('${pageId}')`;
            });
            if (clickedMenu) {
                clickedMenu.classList.add('active');
            }
            
            if (pageId === 'dashboard') {
                setTimeout(initDashboardCharts, 100);
                updateDashboard();
            }
            if (pageId === 'reports') {
                setTimeout(initReportCharts, 100);
                updateReportsPage();
            }
            if (pageId === 'assets') {
                renderAssetsTable();
            }
            if (pageId === 'departments') {
                updateDepartmentPage();
            }
            if (pageId === 'locations') {
                updateLocationsPage();
            }
            if (pageId === 'maintenance') {
                updateMaintenancePage();
            }
        }

        // Initialize Dashboard Charts
        function initDashboardCharts() {
            // Category Chart
            const categoryCtx = document.getElementById('categoryChart');
            if (categoryCtx) {
                if (categoryCtx.chart) {
                    categoryCtx.chart.destroy();
                }

                const categoryData = {};
                assetsData.forEach(asset => {
                    categoryData[asset.category] = (categoryData[asset.category] || 0) + 1;
                });

                const categories = Object.keys(categoryData);
                const counts = Object.values(categoryData);

                categoryCtx.chart = new Chart(categoryCtx, {
                    type: 'doughnut',
                    data: {
                        labels: categories.length > 0 ? categories : ['‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•'],
                        datasets: [{
                            data: counts.length > 0 ? counts : [1],
                            backgroundColor: [
                                '#14b8a6', '#06b6d4', '#10b981', '#f59e0b', '#ef4444',
                                '#8b5cf6', '#ec4899', '#f97316', '#6366f1', '#84cc16'
                            ]
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            }
                        }
                    }
                });
            }

            // Status Chart
            const statusCtx = document.getElementById('statusDashChart');
            if (statusCtx) {
                if (statusCtx.chart) {
                    statusCtx.chart.destroy();
                }

                const statusData = {
                    '‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå': 0,
                    '‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°': 0,
                    '‡∏ä‡∏≥‡∏£‡∏∏‡∏î': 0,
                    '‡πÄ‡∏™‡∏µ‡∏¢': 0
                };

                assetsData.forEach(asset => {
                    if (statusData[asset.status] !== undefined) {
                        statusData[asset.status]++;
                    }
                });

                statusCtx.chart = new Chart(statusCtx, {
                    type: 'bar',
                    data: {
                        labels: Object.keys(statusData),
                        datasets: [{
                            label: '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô',
                            data: Object.values(statusData),
                            backgroundColor: ['#10b981', '#f59e0b', '#fb923c', '#ef4444']
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    stepSize: 1
                                }
                            }
                        }
                    }
                });
            }
        }

        // Initialize Report Charts
        function initReportCharts() {
            // Asset Count Chart
            const assetCountCtx = document.getElementById('assetCountChart');
            if (assetCountCtx) {
                if (assetCountCtx.chart) {
                    assetCountCtx.chart.destroy();
                }

                const categoryData = {};
                assetsData.forEach(asset => {
                    categoryData[asset.category] = (categoryData[asset.category] || 0) + 1;
                });

                const categories = Object.keys(categoryData);
                const counts = Object.values(categoryData);

                assetCountCtx.chart = new Chart(assetCountCtx, {
                    type: 'bar',
                    data: {
                        labels: categories.length > 0 ? categories : ['‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•'],
                        datasets: [{
                            label: '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô (‡∏´‡∏ô‡πà‡∏ß‡∏¢)',
                            data: counts.length > 0 ? counts : [0],
                            backgroundColor: [
                                '#14b8a6', '#06b6d4', '#10b981', '#f59e0b', '#ef4444',
                                '#8b5cf6', '#ec4899', '#f97316', '#6366f1', '#84cc16'
                            ]
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    stepSize: 1
                                }
                            }
                        }
                    }
                });
            }

            // Status Chart
            const statusCtx = document.getElementById('statusChart');
            if (statusCtx) {
                if (statusCtx.chart) {
                    statusCtx.chart.destroy();
                }

                const statusData = {
                    '‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå': 0,
                    '‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°': 0,
                    '‡∏ä‡∏≥‡∏£‡∏∏‡∏î': 0,
                    '‡πÄ‡∏™‡∏µ‡∏¢': 0
                };

                assetsData.forEach(asset => {
                    if (statusData[asset.status] !== undefined) {
                        statusData[asset.status]++;
                    }
                });

                statusCtx.chart = new Chart(statusCtx, {
                    type: 'pie',
                    data: {
                        labels: Object.keys(statusData),
                        datasets: [{
                            data: Object.values(statusData),
                            backgroundColor: ['#10b981', '#f59e0b', '#fb923c', '#ef4444']
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            }
                        }
                    }
                });
            }
        }

        // Update Dashboard
        function updateDashboard() {
            document.getElementById('totalAssets').textContent = assetsData.length;
            
            const complete = assetsData.filter(a => a.status === '‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå').length;
            const repair = assetsData.filter(a => a.status === '‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°').length;
            const damaged = assetsData.filter(a => a.status === '‡∏ä‡∏≥‡∏£‡∏∏‡∏î' || a.status === '‡πÄ‡∏™‡∏µ‡∏¢').length;
            
            document.getElementById('availableAssets').textContent = complete;
            document.getElementById('inUseAssets').textContent = repair;
            document.getElementById('maintenanceAssets').textContent = damaged;
            
            renderRecentAssets();

            // Update charts with new data
            if (assetsData.length > 0) {
                const categoryCtx = document.getElementById('categoryChart');
                if (categoryCtx && categoryCtx.chart) {
                    categoryCtx.chart.destroy();
                    categoryCtx.chart = null;
                }

                const statusCtx = document.getElementById('statusDashChart');
                if (statusCtx && statusCtx.chart) {
                    statusCtx.chart.destroy();
                    statusCtx.chart = null;
                }

                initDashboardCharts();
            }
        }

        // Render Recent Assets
        function renderRecentAssets() {
            const tbody = document.getElementById('recentAssetsTable');
            
            if (assetsData.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="5" style="text-align: center; color: #aaa; padding: 40px;">
                            ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏´‡∏£‡∏∑‡∏≠ Import Excel
                        </td>
                    </tr>
                `;
                return;
            }
            
            const recent = assetsData.slice(-5).reverse();
            tbody.innerHTML = recent.map(asset => `
                <tr>
                    <td>${asset.code}</td>
                    <td>${asset.name}</td>
                    <td>${asset.category}</td>
                    <td><span class="badge ${getStatusClass(asset.status)}">${asset.status}</span></td>
                    <td>${Number(asset.price).toLocaleString()}</td>
                </tr>
            `).join('');
        }

        // Render Assets Table
        function renderAssetsTable() {
            const tbody = document.getElementById('assetsTableBody');
            document.getElementById('assetCount').textContent = assetsData.length;
            
            if (assetsData.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="8" style="text-align: center; color: #aaa; padding: 40px;">
                            ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏´‡∏£‡∏∑‡∏≠ Import Excel
                        </td>
                    </tr>
                `;
                return;
            }
            
            tbody.innerHTML = assetsData.map(asset => `
                <tr>
                    <td>${asset.code}</td>
                    <td>${asset.name}</td>
                    <td>${asset.category}</td>
                    <td>${asset.location}</td>
                    <td>${asset.department || '-'}</td>
                    <td><span class="badge ${getStatusClass(asset.status)}">${asset.status}</span></td>
                    <td>${Number(asset.price).toLocaleString()}</td>
                    <td>
                        <button class="action-btn view"><i class="fas fa-eye"></i></button>
                        <button class="action-btn edit"><i class="fas fa-edit"></i></button>
                        <button class="action-btn delete" onclick="deleteAsset('${asset.code}')"><i class="fas fa-trash"></i></button>
                    </td>
                </tr>
            `).join('');
        }

        // Filter Assets
        function filterAssets() {
            const search = document.getElementById('searchAsset').value.toLowerCase();
            const category = document.getElementById('filterCategory').value;
            const status = document.getElementById('filterStatus').value;
            
            const tbody = document.getElementById('assetsTableBody');
            const rows = tbody.querySelectorAll('tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                const categoryMatch = !category || text.includes(category.toLowerCase());
                const statusMatch = !status || text.includes(status.toLowerCase());
                const searchMatch = !search || text.includes(search);
                
                row.style.display = (categoryMatch && statusMatch && searchMatch) ? '' : 'none';
            });
        }

        // Get Status Class
        function getStatusClass(status) {
            const classes = {
                '‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå': 'complete',
                '‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°': 'repair',
                '‡∏ä‡∏≥‡∏£‡∏∏‡∏î': 'damaged',
                '‡πÄ‡∏™‡∏µ‡∏¢': 'broken',
                // Legacy support
                '‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô': 'available',
                '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô': 'in-use',
                '‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á': 'maintenance',
                '‡πÄ‡∏•‡∏¥‡∏Å‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô': 'retired'
            };
            return classes[status] || 'available';
        }

        // Save New Asset
        async function saveNewAsset() {
            const code = document.getElementById('newAssetCode').value;
            const name = document.getElementById('newAssetName').value;
            const category = document.getElementById('newCategory').value;
            const brand = document.getElementById('newBrand').value;
            const model = document.getElementById('newModel').value;
            const serial = document.getElementById('newSerial').value;
            const purchaseDate = document.getElementById('newPurchaseDate').value;
            const price = document.getElementById('newPrice').value;
            const location = document.getElementById('newLocation').value;
            const department = document.getElementById('newDepartment').value;
            const status = document.getElementById('newStatus').value;
            const description = document.getElementById('newDescription').value;
            
            if (!code || !name || !category || !purchaseDate || !price || !location) {
                showNotification('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô (*)', 'error');
                return;
            }
            
            const asset = {
                code, name, category, brand, model, serial,
                purchaseDate, price, location, department, status, description,
                createdAt: new Date().toISOString()
            };
            
            showLoading();
            
            try {
                // Save to local storage
                assetsData.push(asset);
                localStorage.setItem('fmcgAssets', JSON.stringify(assetsData));
                
                // Save to Google Sheets if configured
                if (sheetsConfig.webAppUrl) {
                    await saveToGoogleSheets([asset]);
                }
                
                hideLoading();
                showNotification('‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
                
                // Clear form
                document.getElementById('newAssetCode').value = '';
                document.getElementById('newAssetName').value = '';
                document.getElementById('newBrand').value = '';
                document.getElementById('newModel').value = '';
                document.getElementById('newSerial').value = '';
                document.getElementById('newDescription').value = '';
                
                updateDashboard();
                showPage('assets');
            } catch (error) {
                hideLoading();
                showNotification('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.message, 'error');
            }
        }

        // Delete Asset
        function deleteAsset(code) {
            if (!confirm('‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô ' + code + ' ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                return;
            }
            
            assetsData = assetsData.filter(a => a.code !== code);
            localStorage.setItem('fmcgAssets', JSON.stringify(assetsData));
            
            showNotification('‚úÖ ‡∏•‡∏ö‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
            renderAssetsTable();
            updateDashboard();
        }

        // Download Template
        function downloadTemplate() {
            const template = [
                ['‡∏£‡∏´‡∏±‡∏™‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô', '‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô', '‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà', '‡∏¢‡∏µ‡πà‡∏´‡πâ‡∏≠', '‡∏£‡∏∏‡πà‡∏ô', 'Serial Number', '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ã‡∏∑‡πâ‡∏≠', '‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ã‡∏∑‡πâ‡∏≠', '‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö', '‡πÅ‡∏ú‡∏ô‡∏Å', '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞', '‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢'],
                ['CUT-001', 'Cutter Safety ‡∏°‡∏µ‡∏î‡∏Ñ‡∏±‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡πå', 'Cutter Safety', 'Safety Plus', 'SP-100', 'CUT001', '2024-01-15', '85', '‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å - ‡πÇ‡∏ã‡∏ô A', 'AC', '‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå', '‡∏°‡∏µ‡∏î‡∏Ñ‡∏±‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÉ‡∏ö‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÑ‡∏î‡πâ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡∏¥‡∏£‡∏†‡∏±‡∏¢'],
                ['GRD-001', '‡∏ï‡∏∞‡πÅ‡∏Å‡∏£‡∏á‡∏Å‡∏£‡∏á ‡∏ï‡∏∞‡πÅ‡∏Å‡∏£‡∏á‡πÄ‡∏´‡∏•‡πá‡∏Å', '‡∏ï‡∏∞‡πÅ‡∏Å‡∏£‡∏á‡∏Å‡∏£‡∏á', 'Metal Grid', 'MG-1000', 'GRD001', '2023-06-10', '2500', '‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å - ‡πÇ‡∏ã‡∏ô A', 'AP', '‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå', '‡∏ï‡∏∞‡πÅ‡∏Å‡∏£‡∏á‡πÄ‡∏´‡∏•‡πá‡∏Å‡∏û‡∏±‡∏ö‡πÑ‡∏î‡πâ ‡∏Ç‡∏ô‡∏≤‡∏î 100x80 ‡∏ã‡∏°.'],
                ['RF-001', 'RF Scanner ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏™‡πÅ‡∏Å‡∏ô', 'RF Scanner', 'Zebra', 'MC3300', 'RF001', '2023-08-15', '35000', '‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å - ‡πÇ‡∏ã‡∏ô B', 'APB', '‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå', '‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏™‡πÅ‡∏Å‡∏ô RF ‡∏û‡∏£‡πâ‡∏≠‡∏° WiFi ‡πÅ‡∏•‡∏∞ Bluetooth'],
                ['IDT-001', 'IData Mobile Computer', 'IData', 'IData', '95W', 'IDT001', '2024-01-10', '28000', '‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å - ‡πÇ‡∏ã‡∏ô C', 'CF', '‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå', '‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á Mobile Computer Android ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡πÅ‡∏Å‡∏ô‡∏ö‡∏≤‡∏£‡πå‡πÇ‡∏Ñ‡πâ‡∏î'],
                ['BATRF-001', '‡πÅ‡∏ö‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡∏µ‡πà RF Scanner', '‡πÅ‡∏ö‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡∏µ‡πà RF', 'Zebra', 'MC3300-BAT', 'BAT001', '2023-08-15', '4500', '‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å - ‡πÇ‡∏ã‡∏ô A', 'APL', '‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå', '‡πÅ‡∏ö‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡∏µ‡πà‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö RF Scanner ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏∏ 7000mAh'],
                ['BATID-001', '‡πÅ‡∏ö‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡∏µ‡πà IData', '‡πÅ‡∏ö‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡∏µ‡πà IData', 'IData', '95W-BAT', 'BIDX001', '2024-01-10', '3800', '‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å - ‡πÇ‡∏ã‡∏ô B', 'CP', '‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå', '‡πÅ‡∏ö‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡∏µ‡πà‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö IData ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏∏ 6000mAh'],
                ['RAD-001', '‡∏ß‡∏¥‡∏ó‡∏¢‡∏∏‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£ Walkie Talkie', '‡∏ß‡∏¥‡∏ó‡∏¢‡∏∏‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£', 'Motorola', 'GP328', 'RAD001', '2023-05-20', '8500', '‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å - ‡πÇ‡∏ã‡∏ô C', 'DP', '‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå', '‡∏ß‡∏¥‡∏ó‡∏¢‡∏∏‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£ UHF ‡∏£‡∏∞‡∏¢‡∏∞ 5 ‡∏Å‡∏°.'],
                ['PLT-001', '‡∏û‡∏≤‡πÄ‡∏•‡∏ó‡πÑ‡∏°‡πâ‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô', '‡∏û‡∏≤‡πÄ‡∏•‡∏ó', 'Standard', 'PT-1200', 'PLT001', '2024-01-15', '1500', '‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å - ‡πÇ‡∏ã‡∏ô A', 'INV', '‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå', '‡∏û‡∏≤‡πÄ‡∏•‡∏ó‡πÑ‡∏°‡πâ‡∏Ç‡∏ô‡∏≤‡∏î 120x100 ‡∏ã‡∏°.'],
                ['TOT-001', 'TOTE ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏û‡∏•‡∏≤‡∏™‡∏ï‡∏¥‡∏Å', 'TOTE', 'Tote Box', 'TB-604025', 'TOT001', '2023-12-10', '850', '‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å - ‡πÇ‡∏ã‡∏ô B', 'LS', '‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå', '‡∏Å‡∏•‡πà‡∏≠‡∏á TOTE ‡∏Ç‡∏ô‡∏≤‡∏î 60x40x25 ‡∏ã‡∏°. ‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô']
            ];
            
            const ws = XLSX.utils.aoa_to_sheet(template);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Template');
            
            // Set column widths
            ws['!cols'] = [
                {wch: 15}, {wch: 30}, {wch: 18}, {wch: 15}, 
                {wch: 15}, {wch: 15}, {wch: 12}, {wch: 12}, 
                {wch: 25}, {wch: 10}, {wch: 12}, {wch: 40}
            ];
            
            XLSX.writeFile(wb, 'Warehouse_Asset_Import_Template.xlsx');
            showNotification('‚úÖ ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î Template ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
        }

        // Handle File Upload
        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            showLoading();
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, {
                        type: 'array',
                        cellDates: true,
                        dateNF: 'yyyy-mm-dd',
                        raw: false
                    });
                    
                    const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                    const jsonData = XLSX.utils.sheet_to_json(firstSheet, {
                        defval: '' // ‡∏Ñ‡πà‡∏≤ default ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö cell ‡∏ß‡πà‡∏≤‡∏á
                    });
                    
                    console.log('Raw data from Excel:', jsonData);
                    
                    importData = jsonData.map((row, index) => {
                        // ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà
                        let purchaseDate = '';
                        const dateValue = row['‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ã‡∏∑‡πâ‡∏≠'] || row['‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà'];
                        if (dateValue) {
                            if (typeof dateValue === 'number') {
                                const excelDate = new Date((dateValue - 25569) * 86400 * 1000);
                                purchaseDate = excelDate.toISOString().split('T')[0];
                            } else if (dateValue.includes('-')) {
                                purchaseDate = dateValue;
                            } else if (dateValue.includes('/')) {
                                const parts = dateValue.split('/');
                                if (parts.length === 3) {
                                    purchaseDate = `${parts[2]}-${parts[1].padStart(2,'0')}-${parts[0].padStart(2,'0')}`;
                                }
                            }
                        }
                        
                        // ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏Ñ‡∏≤ - ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏´‡πâ‡πÉ‡∏™‡πà 0
                        let price = 0;
                        const priceValue = row['‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ã‡∏∑‡πâ‡∏≠'] || row['‡∏£‡∏≤‡∏Ñ‡∏≤'] || row['‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤'];
                        if (priceValue) {
                            price = parseFloat(String(priceValue).replace(/[^0-9.-]/g, '')) || 0;
                        }
                        
                        const asset = {
                            code: row['‡∏£‡∏´‡∏±‡∏™‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô'] || row['‡∏£‡∏´‡∏±‡∏™'] || '',
                            name: row['‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô'] || row['‡∏ä‡∏∑‡πà‡∏≠'] || '',
                            category: row['‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà'] || row['‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó'] || '',
                            brand: row['‡∏¢‡∏µ‡πà‡∏´‡πâ‡∏≠'] || row['‡πÅ‡∏ö‡∏£‡∏ô‡∏î‡πå'] || '',
                            model: row['‡∏£‡∏∏‡πà‡∏ô'] || '',
                            serial: row['Serial Number'] || row['‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏ã‡∏µ‡πÄ‡∏£‡∏µ‡∏¢‡∏•'] || row['Serial'] || '',
                            purchaseDate: purchaseDate,
                            price: price,
                            location: row['‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö'] || row['‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà'] || '',
                            department: row['‡πÅ‡∏ú‡∏ô‡∏Å'] || '',
                            status: row['‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞'] || '‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå',
                            description: row['‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢'] || row['‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏'] || '',
                            createdAt: new Date().toISOString()
                        };
                        
                        console.log(`Row ${index + 1}:`, asset);
                        return asset;
                    });
                    
                    // ‡∏Å‡∏£‡∏≠‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç
                    importData = importData.filter(asset => {
                        return asset.code || asset.name; // ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢‡∏£‡∏´‡∏±‡∏™‡∏´‡∏£‡∏∑‡∏≠‡∏ä‡∏∑‡πà‡∏≠
                    });
                    
                    hideLoading();
                    
                    if (importData.length === 0) {
                        showNotification('‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏ü‡∏•‡πå', 'warning');
                        return;
                    }
                    
                    showPreview();
                    showNotification(`‚úÖ ‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏û‡∏ö ${importData.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`, 'success');
                    
                } catch (error) {
                    hideLoading();
                    console.error('Import error:', error);
                    showNotification('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.message, 'error');
                }
            };
            reader.readAsArrayBuffer(file);
        }

        // Show Preview
        function showPreview() {
            document.getElementById('previewSection').style.display = 'block';
            const tbody = document.getElementById('previewTableBody');
            
            tbody.innerHTML = importData.map(asset => `
                <tr>
                    <td>${asset.code}</td>
                    <td>${asset.name}</td>
                    <td>${asset.category}</td>
                    <td>${asset.location}</td>
                    <td>${asset.department || '-'}</td>
                    <td>${Number(asset.price).toLocaleString()}</td>
                    <td><span class="badge ${getStatusClass(asset.status)}">${asset.status}</span></td>
                </tr>
            `).join('');
        }

        // Confirm Import
        async function confirmImport() {
            if (importData.length === 0) {
                showNotification('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤', 'warning');
                return;
            }
            
            showLoading();
            
            try {
                // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡πÄ‡∏ï‡∏¥‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏î
                const processedData = importData.map(asset => {
                    // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏Ñ‡∏≤‡πÉ‡∏´‡πâ‡πÉ‡∏™‡πà 0
                    if (!asset.price || asset.price === '') {
                        asset.price = 0;
                    }
                    
                    // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÉ‡∏´‡πâ‡πÉ‡∏™‡πà "‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå"
                    if (!asset.status) {
                        asset.status = '‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå';
                    }
                    
                    // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡πÉ‡∏™‡πà "‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å"
                    if (!asset.location) {
                        asset.location = '‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å - ‡πÇ‡∏ã‡∏ô A';
                    }
                    
                    return asset;
                });
                
                // Add to local storage
                assetsData = [...assetsData, ...processedData];
                localStorage.setItem('fmcgAssets', JSON.stringify(assetsData));
                
                // Save to Google Sheets if configured
                if (sheetsConfig.webAppUrl) {
                    await saveToGoogleSheets(processedData);
                }
                
                hideLoading();
                showNotification(`‚úÖ ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ${processedData.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!`, 'success');
                
                importData = [];
                document.getElementById('previewSection').style.display = 'none';
                document.getElementById('excelFile').value = '';
                
                updateDashboard();
                showPage('assets');
            } catch (error) {
                hideLoading();
                showNotification('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.message, 'error');
            }
        }

        // Update Department Page Data
        function updateDepartmentPage() {
            if (assetsData.length === 0) {
                document.getElementById('departmentBreakdownBody').innerHTML = `
                    <tr>
                        <td colspan="7" style="text-align: center; color: #aaa; padding: 40px;">
                            ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô
                        </td>
                    </tr>
                `;
                document.getElementById('departmentCardsGrid').innerHTML = `
                    <div style="grid-column: 1/-1; text-align: center; padding: 40px; color: #aaa;">
                        ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏´‡∏£‡∏∑‡∏≠ Import Excel
                    </div>
                `;
                return;
            }

            // Group assets by department
            const departmentData = {};
            const departments = ['‡∏™‡∏≥‡∏£‡∏≠‡∏á', 'AC', 'AP', 'APB', 'CF', 'APL', 'CP', 'DP', 'INV', 'LS', 'QA', 'RC', 'ST'];
            
            departments.forEach(dept => {
                departmentData[dept] = {
                    ‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå: 0,
                    '‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°': 0,
                    ‡∏ä‡∏≥‡∏£‡∏∏‡∏î: 0,
                    ‡πÄ‡∏™‡∏µ‡∏¢: 0,
                    total: 0,
                    value: 0
                };
            });

            // Count assets by department and status
            assetsData.forEach(asset => {
                const dept = asset.department || '‡∏™‡∏≥‡∏£‡∏≠‡∏á';
                const status = asset.status || '‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå';
                
                if (departmentData[dept]) {
                    if (departmentData[dept][status] !== undefined) {
                        departmentData[dept][status]++;
                    }
                    departmentData[dept].total++;
                    departmentData[dept].value += Number(asset.price) || 0;
                }
            });

            // Update total departments stat
            const activeDepts = Object.keys(departmentData).filter(dept => departmentData[dept].total > 0);
            document.getElementById('totalDepartments').textContent = activeDepts.length;

            // Calculate totals
            let totalComplete = 0, totalRepair = 0, totalDamaged = 0;
            Object.values(departmentData).forEach(data => {
                totalComplete += data.‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå;
                totalRepair += data['‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°'];
                totalDamaged += data.‡∏ä‡∏≥‡∏£‡∏∏‡∏î + data.‡πÄ‡∏™‡∏µ‡∏¢;
            });

            document.getElementById('totalComplete').textContent = totalComplete;
            document.getElementById('totalRepair').textContent = totalRepair;
            document.getElementById('totalDamaged').textContent = totalDamaged;

            // Render department breakdown table
            const tbody = document.getElementById('departmentBreakdownBody');
            tbody.innerHTML = departments.map(dept => {
                const data = departmentData[dept];
                if (data.total === 0) return ''; // Skip empty departments
                
                return `
                    <tr>
                        <td><strong>${dept}</strong></td>
                        <td style="text-align: center;">
                            <span class="badge complete">${data.‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå}</span>
                        </td>
                        <td style="text-align: center;">
                            <span class="badge repair">${data['‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°']}</span>
                        </td>
                        <td style="text-align: center;">
                            <span class="badge damaged">${data.‡∏ä‡∏≥‡∏£‡∏∏‡∏î}</span>
                        </td>
                        <td style="text-align: center;">
                            <span class="badge broken">${data.‡πÄ‡∏™‡∏µ‡∏¢}</span>
                        </td>
                        <td style="text-align: center;"><strong>${data.total}</strong></td>
                        <td>
                            <button class="action-btn view" onclick="viewDepartmentDetail('${dept}')">
                                <i class="fas fa-eye"></i> ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î
                            </button>
                        </td>
                    </tr>
                `;
            }).filter(row => row).join('');

            // Update department charts
            updateDepartmentCharts(departmentData);
            
            // Render department cards
            renderDepartmentCards(departmentData);
        }

        // Update Department Charts
        function updateDepartmentCharts(departmentData) {
            const departments = Object.keys(departmentData).filter(dept => departmentData[dept].total > 0);
            const totals = departments.map(dept => departmentData[dept].total);
            const colors = [
                '#14b8a6', '#06b6d4', '#10b981', '#f59e0b', '#ef4444', 
                '#8b5cf6', '#ec4899', '#f97316', '#6366f1', '#84cc16',
                '#06b6d4', '#f43f5e', '#14b8a6'
            ];

            // Bar Chart - Assets per Department
            const barCtx = document.getElementById('departmentAssetChart');
            if (barCtx) {
                if (barCtx.chart) {
                    barCtx.chart.destroy();
                }
                barCtx.chart = new Chart(barCtx, {
                    type: 'bar',
                    data: {
                        labels: departments,
                        datasets: [{
                            label: '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô',
                            data: totals,
                            backgroundColor: colors.slice(0, departments.length)
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    stepSize: 1
                                }
                            }
                        }
                    }
                });
            }

            // Pie Chart - Proportion by Department
            const pieCtx = document.getElementById('departmentPieChart');
            if (pieCtx) {
                if (pieCtx.chart) {
                    pieCtx.chart.destroy();
                }
                pieCtx.chart = new Chart(pieCtx, {
                    type: 'pie',
                    data: {
                        labels: departments,
                        datasets: [{
                            data: totals,
                            backgroundColor: colors.slice(0, departments.length)
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        plugins: {
                            legend: {
                                position: 'right'
                            }
                        }
                    }
                });
            }
        }

        // Render Department Cards
        function renderDepartmentCards(departmentData) {
            const container = document.getElementById('departmentCardsGrid');
            if (!container) return;

            const departments = Object.keys(departmentData).filter(dept => departmentData[dept].total > 0);
            
            container.innerHTML = departments.map(dept => {
                const data = departmentData[dept];
                const percentage = {
                    complete: ((data.‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå / data.total) * 100).toFixed(1),
                    repair: ((data['‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°'] / data.total) * 100).toFixed(1),
                    damaged: ((data.‡∏ä‡∏≥‡∏£‡∏∏‡∏î / data.total) * 100).toFixed(1),
                    broken: ((data.‡πÄ‡∏™‡∏µ‡∏¢ / data.total) * 100).toFixed(1)
                };

                return `
                    <div class="table-container" style="margin-bottom: 20px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                            <div>
                                <h3 style="color: #333; font-size: 18px; margin-bottom: 5px;">
                                    <i class="fas fa-building"></i> ‡πÅ‡∏ú‡∏ô‡∏Å ${dept}
                                </h3>
                                <p style="color: #666; font-size: 14px;">
                                    ‡∏£‡∏ß‡∏° ${data.total} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ | ‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤ ‡∏ø${data.value.toLocaleString()}
                                </p>
                            </div>
                            <button class="btn btn-info" onclick="viewDepartmentDetail('${dept}')">
                                <i class="fas fa-eye"></i> ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î
                            </button>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
                            <div style="padding: 15px; background: #d1fae5; border-radius: 10px; text-align: center;">
                                <div style="font-size: 24px; font-weight: bold; color: #065f46;">${data.‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå}</div>
                                <div style="font-size: 12px; color: #065f46; margin-top: 5px;">‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå (${percentage.complete}%)</div>
                            </div>
                            
                            <div style="padding: 15px; background: #fef3c7; border-radius: 10px; text-align: center;">
                                <div style="font-size: 24px; font-weight: bold; color: #92400e;">${data['‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°']}</div>
                                <div style="font-size: 12px; color: #92400e; margin-top: 5px;">‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏° (${percentage.repair}%)</div>
                            </div>
                            
                            <div style="padding: 15px; background: #fed7aa; border-radius: 10px; text-align: center;">
                                <div style="font-size: 24px; font-weight: bold; color: #9a3412;">${data.‡∏ä‡∏≥‡∏£‡∏∏‡∏î}</div>
                                <div style="font-size: 12px; color: #9a3412; margin-top: 5px;">‡∏ä‡∏≥‡∏£‡∏∏‡∏î (${percentage.damaged}%)</div>
                            </div>
                            
                            <div style="padding: 15px; background: #fee2e2; border-radius: 10px; text-align: center;">
                                <div style="font-size: 24px; font-weight: bold; color: #991b1b;">${data.‡πÄ‡∏™‡∏µ‡∏¢}</div>
                                <div style="font-size: 12px; color: #991b1b; margin-top: 5px;">‡πÄ‡∏™‡∏µ‡∏¢ (${percentage.broken}%)</div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // View Department Detail
        function viewDepartmentDetail(department) {
            const deptAssets = assetsData.filter(a => (a.department || '‡∏™‡∏≥‡∏£‡∏≠‡∏á') === department);
            
            if (deptAssets.length === 0) {
                showNotification('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡πÉ‡∏ô‡πÅ‡∏ú‡∏ô‡∏Å‡∏ô‡∏µ‡πâ', 'warning');
                return;
            }

            // Create modal content
            const modalHtml = `
                <div class="modal active" id="departmentModal" onclick="if(event.target === this) closeDepartmentModal()">
                    <div class="modal-content" style="max-width: 1000px;">
                        <div class="modal-header">
                            <h3><i class="fas fa-building"></i> ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÅ‡∏ú‡∏ô‡∏Å ${department}</h3>
                            <button class="close-modal" onclick="closeDepartmentModal()">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <div class="stats-grid" style="grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));">
                                <div class="stat-card" style="padding: 15px;">
                                    <div class="stat-info">
                                        <h3>${deptAssets.length}</h3>
                                        <p>‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                                    </div>
                                </div>
                                <div class="stat-card" style="padding: 15px;">
                                    <div class="stat-info">
                                        <h3>${deptAssets.filter(a => a.status === '‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå').length}</h3>
                                        <p>‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå</p>
                                    </div>
                                </div>
                                <div class="stat-card" style="padding: 15px;">
                                    <div class="stat-info">
                                        <h3>${deptAssets.filter(a => a.status === '‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°').length}</h3>
                                        <p>‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°</p>
                                    </div>
                                </div>
                                <div class="stat-card" style="padding: 15px;">
                                    <div class="stat-info">
                                        <h3>‡∏ø${deptAssets.reduce((sum, a) => sum + (Number(a.price) || 0), 0).toLocaleString()}</h3>
                                        <p>‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏£‡∏ß‡∏°</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div style="overflow-x: auto;">
                            <table>
                                <thead>
                                    <tr>
                                        <th>‡∏£‡∏´‡∏±‡∏™</th>
                                        <th>‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô</th>
                                        <th>‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</th>
                                        <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà</th>
                                        <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                                        <th>‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤ (‡∏ø)</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${deptAssets.map(asset => `
                                        <tr>
                                            <td>${asset.code}</td>
                                            <td>${asset.name}</td>
                                            <td>${asset.category}</td>
                                            <td>${asset.location}</td>
                                            <td><span class="badge ${getStatusClass(asset.status)}">${asset.status}</span></td>
                                            <td>${Number(asset.price).toLocaleString()}</td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                        
                        <div class="form-actions" style="margin-top: 20px;">
                            <button class="btn btn-success" onclick="exportDepartmentDetail('${department}')">
                                <i class="fas fa-file-excel"></i> Export Excel
                            </button>
                            <button class="btn btn-secondary" onclick="closeDepartmentModal()">
                                <i class="fas fa-times"></i> ‡∏õ‡∏¥‡∏î
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            // Remove existing modal if any
            const existingModal = document.getElementById('departmentModal');
            if (existingModal) {
                existingModal.remove();
            }
            
            // Add modal to body
            document.body.insertAdjacentHTML('beforeend', modalHtml);
        }

        // Close Department Modal
        function closeDepartmentModal() {
            const modal = document.getElementById('departmentModal');
            if (modal) {
                modal.classList.remove('active');
                setTimeout(() => modal.remove(), 300);
            }
        }

        // Export Department Detail
        function exportDepartmentDetail(department) {
            const deptAssets = assetsData.filter(a => (a.department || '‡∏™‡∏≥‡∏£‡∏≠‡∏á') === department);
            
            if (deptAssets.length === 0) {
                showNotification('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ Export', 'warning');
                return;
            }
            
            const data = deptAssets.map(asset => ({
                '‡∏£‡∏´‡∏±‡∏™‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô': asset.code,
                '‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô': asset.name,
                '‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà': asset.category,
                '‡∏¢‡∏µ‡πà‡∏´‡πâ‡∏≠': asset.brand,
                '‡∏£‡∏∏‡πà‡∏ô': asset.model,
                'Serial Number': asset.serial,
                '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ã‡∏∑‡πâ‡∏≠': asset.purchaseDate,
                '‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ã‡∏∑‡πâ‡∏≠': asset.price,
                '‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö': asset.location,
                '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞': asset.status,
                '‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢': asset.description
            }));
            
            const ws = XLSX.utils.json_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, `‡πÅ‡∏ú‡∏ô‡∏Å ${department}`);
            
            const date = new Date().toISOString().split('T')[0];
            XLSX.writeFile(wb, `Department_${department}_${date}.xlsx`);
            
            showNotification(`‚úÖ Export ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ú‡∏ô‡∏Å ${department} ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!`, 'success');
        }

        // Export Department Report
        function exportDepartmentReport() {
            if (assetsData.length === 0) {
                showNotification('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ Export', 'warning');
                return;
            }
            
            // Create workbook
            const wb = XLSX.utils.book_new();
            
            // Summary sheet
            const departments = ['‡∏™‡∏≥‡∏£‡∏≠‡∏á', 'AC', 'AP', 'APB', 'CF', 'APL', 'CP', 'DP', 'INV', 'LS', 'QA', 'RC', 'ST'];
            const summaryData = [['‡πÅ‡∏ú‡∏ô‡∏Å', '‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå', '‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°', '‡∏ä‡∏≥‡∏£‡∏∏‡∏î', '‡πÄ‡∏™‡∏µ‡∏¢', '‡∏£‡∏ß‡∏°', '‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏£‡∏ß‡∏° (‡∏ø)']];
            
            departments.forEach(dept => {
                const deptAssets = assetsData.filter(a => (a.department || '‡∏™‡∏≥‡∏£‡∏≠‡∏á') === dept);
                if (deptAssets.length > 0) {
                    summaryData.push([
                        dept,
                        deptAssets.filter(a => a.status === '‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå').length,
                        deptAssets.filter(a => a.status === '‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°').length,
                        deptAssets.filter(a => a.status === '‡∏ä‡∏≥‡∏£‡∏∏‡∏î').length,
                        deptAssets.filter(a => a.status === '‡πÄ‡∏™‡∏µ‡∏¢').length,
                        deptAssets.length,
                        deptAssets.reduce((sum, a) => sum + (Number(a.price) || 0), 0)
                    ]);
                }
            });
            
            const summaryWs = XLSX.utils.aoa_to_sheet(summaryData);
            XLSX.utils.book_append_sheet(wb, summaryWs, '‡∏™‡∏£‡∏∏‡∏õ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°');
            
            // Detail sheets for each department
            departments.forEach(dept => {
                const deptAssets = assetsData.filter(a => (a.department || '‡∏™‡∏≥‡∏£‡∏≠‡∏á') === dept);
                if (deptAssets.length > 0) {
                    const data = deptAssets.map(asset => ({
                        '‡∏£‡∏´‡∏±‡∏™‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô': asset.code,
                        '‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô': asset.name,
                        '‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà': asset.category,
                        '‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà': asset.location,
                        '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞': asset.status,
                        '‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤': asset.price
                    }));
                    
                    const ws = XLSX.utils.json_to_sheet(data);
                    XLSX.utils.book_append_sheet(wb, ws, dept);
                }
            });
            
            const date = new Date().toISOString().split('T')[0];
            XLSX.writeFile(wb, `Department_Report_${date}.xlsx`);
            
            showNotification('‚úÖ Export ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÅ‡∏¢‡∏Å‡πÅ‡∏ú‡∏ô‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
        }

        // Update Locations Page with Real Data
        function updateLocationsPage() {
            if (assetsData.length === 0) {
                const tbody = document.getElementById('locationsTableBody');
                if (tbody) {
                    tbody.innerHTML = `
                        <tr>
                            <td colspan="5" style="text-align: center; color: #aaa; padding: 40px;">
                                ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô
                            </td>
                        </tr>
                    `;
                }
                return;
            }

            // Count assets by location
            const locationData = {};
            
            assetsData.forEach(asset => {
                const loc = asset.location || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏';
                if (!locationData[loc]) {
                    locationData[loc] = {
                        total: 0,
                        complete: 0
                    };
                }
                locationData[loc].total++;
                if (asset.status === '‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå') {
                    locationData[loc].complete++;
                }
            });

            // Calculate totals
            const totalLocations = Object.keys(locationData).length;
            const totalAssets = assetsData.length;
            const totalComplete = assetsData.filter(a => a.status === '‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå').length;
            const avgCapacity = totalAssets > 0 ? Math.round((totalComplete / totalAssets) * 100) : 0;
            const fullLocations = Object.values(locationData).filter(loc => {
                const capacity = Math.round((loc.complete / loc.total) * 100);
                return capacity >= 90;
            }).length;

            // Update stats
            document.getElementById('totalLocations').textContent = totalLocations;
            document.getElementById('avgCapacity').textContent = avgCapacity + '%';
            document.getElementById('totalAssetsInLocations').textContent = totalAssets;
            document.getElementById('fullLocations').textContent = fullLocations;

            // Update location table
            const tbody = document.getElementById('locationsTableBody');
            if (tbody) {
                tbody.innerHTML = Object.entries(locationData).map(([location, data]) => {
                    const capacity = Math.round((data.complete / data.total) * 100);
                    const statusClass = capacity >= 90 ? 'maintenance' : capacity >= 75 ? 'in-use' : 'available';
                    const statusText = capacity >= 90 ? '‡πÄ‡∏Å‡∏∑‡∏≠‡∏ö‡πÄ‡∏ï‡πá‡∏°' : capacity >= 75 ? '‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥' : '‡∏ß‡πà‡∏≤‡∏á';
                    
                    return `
                        <tr>
                            <td>${location}</td>
                            <td>-</td>
                            <td>${data.total}</td>
                            <td>${capacity}%</td>
                            <td><span class="badge ${statusClass}">${statusText}</span></td>
                        </tr>
                    `;
                }).join('');
            }
        }

        // Update Maintenance Page with Real Data
        function updateMaintenancePage() {
            if (assetsData.length === 0) {
                const tbody = document.getElementById('maintenanceTableBody');
                if (tbody) {
                    tbody.innerHTML = `
                        <tr>
                            <td colspan="5" style="text-align: center; color: #aaa; padding: 40px;">
                                ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á
                            </td>
                        </tr>
                    `;
                }
                return;
            }

            // Calculate maintenance stats
            const scheduledCount = assetsData.filter(a => a.status === '‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°').length;
            const inProgressCount = Math.ceil(scheduledCount / 2);
            const completedCount = assetsData.filter(a => a.status === '‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå').length;
            const totalMaintenanceCost = assetsData
                .filter(a => a.status === '‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°' || a.status === '‡∏ä‡∏≥‡∏£‡∏∏‡∏î')
                .reduce((sum, a) => sum + (Number(a.price) * 0.1), 0); // 10% of asset value as maintenance cost

            // Update stats
            document.getElementById('scheduledMaintenance').textContent = scheduledCount;
            document.getElementById('inProgressMaintenance').textContent = inProgressCount;
            document.getElementById('completedMaintenance').textContent = completedCount;
            
            const costK = Math.round(totalMaintenanceCost / 1000);
            document.getElementById('maintenanceCost').textContent = '‡∏ø' + costK + 'K';

            // Update maintenance table with actual repair items
            const tbody = document.getElementById('maintenanceTableBody');
            if (tbody) {
                const repairAssets = assetsData.filter(a => a.status === '‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°' || a.status === '‡∏ä‡∏≥‡∏£‡∏∏‡∏î');
                
                if (repairAssets.length === 0) {
                    tbody.innerHTML = `
                        <tr>
                            <td colspan="5" style="text-align: center; color: #aaa; padding: 40px;">
                                ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á
                            </td>
                        </tr>
                    `;
                } else {
                    tbody.innerHTML = repairAssets.slice(0, 10).map(asset => {
                        const maintenanceType = asset.status === '‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°' ? '‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°' : '‡∏ã‡πà‡∏≠‡∏°‡πÅ‡∏ã‡∏°';
                        const statusClass = asset.status === '‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°' ? 'in-use' : 'maintenance';
                        const statusText = asset.status === '‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°' ? '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£' : '‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£';
                        const dueDate = new Date(Date.now() + Math.random() * 30 * 24 * 60 * 60 * 1000).toLocaleDateString('th-TH');
                        
                        return `
                            <tr>
                                <td>${asset.code}</td>
                                <td>${asset.name}</td>
                                <td>${maintenanceType}</td>
                                <td>${dueDate}</td>
                                <td><span class="badge ${statusClass}">${statusText}</span></td>
                            </tr>
                        `;
                    }).join('');
                }
            }
        }

        // Update Reports Page with Real Data
        function updateReportsPage() {
            if (assetsData.length === 0) return;

            // Calculate real values
            const totalValue = assetsData.reduce((sum, asset) => sum + (Number(asset.price) || 0), 0);
            const depreciation = totalValue * 0.15; // 15% depreciation
            const maintenanceCost = assetsData
                .filter(a => a.status === '‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°' || a.status === '‡∏ä‡∏≥‡∏£‡∏∏‡∏î')
                .reduce((sum, a) => sum + (Number(a.price) * 0.1), 0);
            const completeCount = assetsData.filter(a => a.status === '‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå').length;
            const usageRate = assetsData.length > 0 ? Math.round((completeCount / assetsData.length) * 100) : 0;

            // Format large numbers
            const formatValue = (value) => {
                if (value >= 1000000) {
                    return '‡∏ø' + (value / 1000000).toFixed(1) + 'M';
                } else if (value >= 1000) {
                    return '‡∏ø' + Math.round(value / 1000) + 'K';
                } else {
                    return '‡∏ø' + Math.round(value);
                }
            };

            // Update stats
            document.getElementById('totalValue').textContent = formatValue(totalValue);
            document.getElementById('depreciationValue').textContent = formatValue(depreciation);
            document.getElementById('maintenanceValueReport').textContent = formatValue(maintenanceCost);
            document.getElementById('usageRate').textContent = usageRate + '%';
        }

        // Load Data from Google Sheets
        async function loadFromGoogleSheets() {
            const { webAppUrl } = sheetsConfig;
            
            if (!webAppUrl) {
                showNotification('https://script.google.com/macros/s/AKfycbzcSH7cQ3kYiSvMkj49uounseXuUAwH6q2iFS85fZFV8FcwoC0X5ojPOJpRNt1PAuge/exec', 'error');
                return;
            }
            
            showLoading();
            
            try {
                const response = await fetch(webAppUrl);
                
                if (!response.ok) {
                    throw new Error('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ');
                }
                
                const result = await response.json();
                
                if (!result.success || !result.data || result.data.length <= 1) {
                    hideLoading();
                    showNotification('‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô Google Sheets', 'warning');
                    return;
                }
                
                const loadedAssets = result.data.slice(1).map(row => ({
                    code: row[0] || '',
                    name: row[1] || '',
                    category: row[2] || '',
                    brand: row[3] || '',
                    model: row[4] || '',
                    serial: row[5] || '',
                    purchaseDate: row[6] || '',
                    price: row[7] || 0,
                    location: row[8] || '',
                    department: row[9] || '',
                    status: row[10] || '‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå',
                    description: row[11] || '',
                    createdAt: row[12] || new Date().toISOString()
                })).filter(asset => asset.code && asset.name);
                
                assetsData = loadedAssets;
                localStorage.setItem('fmcgAssets', JSON.stringify(assetsData));
                
                hideLoading();
                showNotification(`‚úÖ ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ${loadedAssets.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!`, 'success');
                
                updateDashboard();
                renderAssetsTable();
                
            } catch (error) {
                hideLoading();
                showNotification('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.message, 'error');
            }
        }

        // Save to Google Sheets
        async function saveToGoogleSheets(assets) {
            const { webAppUrl } = sheetsConfig;
            
            if (!webAppUrl) {
                throw new Error('https://script.google.com/macros/s/AKfycbzcSH7cQ3kYiSvMkj49uounseXuUAwH6q2iFS85fZFV8FcwoC0X5ojPOJpRNt1PAuge/exec');
            }
            
            const rows = assets.map(asset => [
                asset.code, asset.name, asset.category, asset.brand, asset.model,
                asset.serial, asset.purchaseDate, asset.price, asset.location,
                asset.department || '', asset.status, asset.description, asset.createdAt
            ]);
            
            const response = await fetch(webAppUrl, {
                method: 'POST',
                body: JSON.stringify({
                    action: 'append',
                    rows: rows
                })
            });
            
            if (!response.ok) {
                throw new Error('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ');
            }
            
            const result = await response.json();
            
            if (!result.success) {
                throw new Error(result.error || '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å');
            }
            
            return result;
        }

        // Initialize Google Sheets with Headers
        async function initializeGoogleSheets() {
            const { webAppUrl } = sheetsConfig;
            
            if (!webAppUrl) {
                showNotification('https://script.google.com/macros/s/AKfycbzcSH7cQ3kYiSvMkj49uounseXuUAwH6q2iFS85fZFV8FcwoC0X5ojPOJpRNt1PAuge/exec');
                return;
            }
            
            showLoading();
            
            try {
                const headers = [
                    '‡∏£‡∏´‡∏±‡∏™‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô', '‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô', '‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà', '‡∏¢‡∏µ‡πà‡∏´‡πâ‡∏≠', '‡∏£‡∏∏‡πà‡∏ô', 
                    'Serial Number', '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ã‡∏∑‡πâ‡∏≠', '‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ã‡∏∑‡πâ‡∏≠', '‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö', '‡πÅ‡∏ú‡∏ô‡∏Å', '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞', 
                    '‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢', '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á'
                ];
                
                const response = await fetch(webAppUrl, {
                    method: 'POST',
                    body: JSON.stringify({
                        action: 'initialize',
                        headers: headers
                    })
                });
                
                if (!response.ok) {
                    throw new Error('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÑ‡∏î‡πâ');
                }
                
                const result = await response.json();
                
                if (!result.success) {
                    throw new Error(result.error || '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î');
                }
                
                hideLoading();
                showNotification('‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
                
            } catch (error) {
                hideLoading();
                showNotification('‚ùå ' + error.message, 'error');
            }
        }

        // Test Connection
        async function testConnection() {
            const webAppUrl = document.getElementById('webAppUrl').value;
            
            if (!webAppUrl) {
                showNotification('https://script.google.com/macros/s/AKfycbzcSH7cQ3kYiSvMkj49uounseXuUAwH6q2iFS85fZFV8FcwoC0X5ojPOJpRNt1PAuge/exec', 'warning');
                return;
            }
            
            showLoading();
            
            try {
                const response = await fetch(webAppUrl);
                
                if (!response.ok) {
                    throw new Error('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ');
                }
                
                const data = await response.json();
                
                sheetsConfig = { webAppUrl, sheetName: 'Assets' };
                localStorage.setItem('fmcgSheetsConfig', JSON.stringify(sheetsConfig));
                
                hideLoading();
                
                const resultDiv = document.getElementById('connectionResult');
                resultDiv.style.display = 'block';
                resultDiv.style.background = '#d1fae5';
                resultDiv.style.border = '1px solid #10b981';
                resultDiv.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 10px; color: #065f46;">
                        <i class="fas fa-check-circle" style="font-size: 24px;"></i>
                        <div>
                            <strong>‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</strong>
                            <p style="margin-top: 5px;">‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ${data.data ? data.data.length - 1 : 0} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</p>
                        </div>
                    </div>
                `;
                
                updateSheetsStatus(true);
                showNotification('‚úÖ ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Google Apps Script ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
                
            } catch (error) {
                hideLoading();
                
                const resultDiv = document.getElementById('connectionResult');
                resultDiv.style.display = 'block';
                resultDiv.style.background = '#fee2e2';
                resultDiv.style.border = '1px solid #ef4444';
                resultDiv.innerHTML = `
                    <div style="display: flex; align-items: start; gap: 10px; color: #991b1b;">
                        <i class="fas fa-times-circle" style="font-size: 24px;"></i>
                        <div>
                            <strong>‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</strong>
                            <p style="margin-top: 5px;">${error.message}</p>
                        </div>
                    </div>
                `;
                
                showNotification('‚ùå ' + error.message, 'error');
            }
        }

        // Update Sheets Status
        function updateSheetsStatus(connected) {
            const statusEl = document.getElementById('sheetsStatus');
            if (connected) {
                statusEl.innerHTML = `
                    <span class="config-status connected">
                        <i class="fas fa-check-circle"></i>
                        ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÅ‡∏•‡πâ‡∏ß
                    </span>
                `;
            } else {
                statusEl.innerHTML = `
                    <span class="config-status disconnected">
                        <i class="fas fa-times-circle"></i>
                        ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
                    </span>
                `;
            }
        }

        // Save Settings
        function saveSettings() {
            const webAppUrl = document.getElementById('webAppUrl').value;
            const companyName = document.getElementById('companyName').value;
            
            sheetsConfig = { webAppUrl, sheetName: 'Assets' };
            localStorage.setItem('fmcgSheetsConfig', JSON.stringify(sheetsConfig));
            localStorage.setItem('fmcgCompanyName', companyName);
            
            showNotification('‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
        }

        // Export to Excel
        function exportToExcel() {
            if (assetsData.length === 0) {
                showNotification('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ Export', 'warning');
                return;
            }
            
            const data = assetsData.map(asset => ({
                '‡∏£‡∏´‡∏±‡∏™‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô': asset.code,
                '‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô': asset.name,
                '‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà': asset.category,
                '‡∏¢‡∏µ‡πà‡∏´‡πâ‡∏≠': asset.brand,
                '‡∏£‡∏∏‡πà‡∏ô': asset.model,
                'Serial Number': asset.serial,
                '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ã‡∏∑‡πâ‡∏≠': asset.purchaseDate,
                '‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ã‡∏∑‡πâ‡∏≠': asset.price,
                '‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö': asset.location,
                '‡πÅ‡∏ú‡∏ô‡∏Å': asset.department || '',
                '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞': asset.status,
                '‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢': asset.description
            }));
            
            const ws = XLSX.utils.json_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Assets');
            
            const date = new Date().toISOString().split('T')[0];
            XLSX.writeFile(wb, `Asset_Export_${date}.xlsx`);
            
            showNotification('‚úÖ Export Excel ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
        }

        // Show Notification
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            const title = document.getElementById('notificationTitle');
            const msg = document.getElementById('notificationMessage');
            
            notification.className = 'notification active ' + type;
            
            if (type === 'success') {
                title.innerHTML = '<i class="fas fa-check-circle"></i> ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!';
            } else if (type === 'error') {
                title.innerHTML = '<i class="fas fa-times-circle"></i> ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î';
            } else {
                title.innerHTML = '<i class="fas fa-exclamation-triangle"></i> ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô';
            }
            
            msg.textContent = message;
            
            setTimeout(() => {
                notification.classList.remove('active');
            }, 3000);
        }

        // Loading Functions
        function showLoading() {
            document.getElementById('loading').classList.add('active');
        }

        function hideLoading() {
            document.getElementById('loading').classList.remove('active');
        }

        // Initialize on load
        window.addEventListener('load', function() {
            // Load data from localStorage
            const savedAssets = localStorage.getItem('fmcgAssets');
            if (savedAssets) {
                assetsData = JSON.parse(savedAssets);
            }
            
            const savedConfig = localStorage.getItem('fmcgSheetsConfig');
            if (savedConfig) {
                sheetsConfig = JSON.parse(savedConfig);
                document.getElementById('webAppUrl').value = sheetsConfig.webAppUrl;
                updateSheetsStatus(true);
            }
            
            const savedCompany = localStorage.getItem('fmcgCompanyName');
            if (savedCompany) {
                document.getElementById('companyName').value = savedCompany;
            }
            
            initDashboardCharts();
            updateDashboard();

            // Initialize other pages if there's data
            if (assetsData.length > 0) {
                updateDepartmentPage();
                updateLocationsPage();
                updateMaintenancePage();
                updateReportsPage();
            }
        });

        // Close modal on outside click
        window.onclick = function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.classList.remove('active');
                }
            });
        };
    </script>
</body>
</html>
